%title Hessian Matrix and Stationary Point Type
= Hessian Matrix and Stationary Point Type =

 先说结论：
 
1. 如果驻点(Stationary Point)处的Hessian矩阵正定，那么驻点是极小值点；
2. 如果驻点处的Hessian矩阵负定，那么驻点是极大值点；
3. 如果驻点处的Hessian矩阵不定，那么驻点是鞍点。
4. 如果驻点处的Hessian矩阵半正定或者半负定，那么无法判断驻点的类型。


== 一个不严谨的证明 ==
之所以说是一个`严谨`的证明，是因为这个证明我不记得是在哪里看到的，而且这个证明中，有一点我还没想明白。

函数$f(x)$是多元函数，将其在$x_0$点泰勒展开到第三项：$f(x) = f(x_0) + \nabla f(x_0)^T(x - x_0) + \frac{1}{2} (x - x_0)^T \nabla^2 f(x_0) (x-x_0)$

若$x_0$是驻点，也即$\nabla f(x_0) = 0$，那么在驻点处的泰勒展开变为：$f(x) - f(x_0) = \frac{1}{2} (x-x_0)^T \nabla^2 f(x_0)(x - x_0)$

从而推出，$f(x) - f(x_0)$ 与$\frac{1}{2} (x-x_0)^T \nabla^2 f(x_0)(x-x_0)$同正负

所以，有如下结论：

1. Hessian矩阵$\nabla^2 f(x_0)$为正定矩阵，那么在$x_0$点的邻域附近有$f(x) - f(x_0) > 0$，所以$x_0$是极小值点。
2. Hessian矩阵$\nabla^2 f(x_0)$为负定矩阵，那么在$x_0$点的邻域附近有$f(x) - f(x_0) < 0$，所以$x_0$是极大值点。
3. Hessian矩阵$\nabla^2 f(x_0)$为不定矩阵，那么在$x_0$点的邻域附近有$f(x) - f(x_0) > 0$或$f(x) - f(x_0) < 0$，所以$x_0$是鞍点。


----
这里有两个问题
1. $f(x) - f(x_0)$ 一定与$\frac{1}{2} (x-x_0)^T \nabla^2 f(x_0)(x-x_0)$同正负吗
	- 因为泰勒展开的是有误差的，所以可能$f(x) - f(x_0) = 0.001$而$\frac{1}{2} (x-x_0)^T \nabla^2 f(x_0)(x-x_0) = -0.001$
	- 我就想不明白这点，所以才说这个证明是不严谨的
2. Hessian矩阵$\nabla^2f(x_0)$可能在$x_0$的邻域内正定，而在这邻域之外不定，那么对于所有的$x$而言，该Hessian矩阵就是不定的，但是$x_0$邻域内正定，不是说明该点是极小值点吗？
	- 所以我当初学这个结论时，就认为要求`正定`这个要求是不是太强了，只要要求在$x_0$的邻域内正定不就行了吗。当初我被这个想法卡住了很久
	- 后来发现，不可能在邻域内正定，而在邻域之外负定。

考虑二元函数$f(x,y)$，假设$(x_0,y_0)$为驻点，那么点$(x_0,y_0)$的长度为1的邻域为$(x-x_0)^2 + (y-y_0)^2 = 1$。

不妨令$(x_0,y_0) = 0$，因为若$(x_0,y_0) \neq (0,0)$，那么可通过平移函数图像，使得$(x_0,y_0)=(0,0)$，那么邻域变为$x^2 + y^2 = 1$

设$a>0,d>0$，则标准型的不定矩阵为

\begin{equation}
{
	\left[ 
		\begin{array}{cc}
		a & 0 \\
		0 & -d \\
		\end{array} 
	\right]
}
\end{equation}

其二次型为$ax^2 - dy^2 = a(1-y^2) - dy^2 = a - ay^2 - dy^2$，则当$y=1$时，该二次型等于$-d$小于$0$。

可以将上面的邻域变为任意小，都能证明该邻域内存在使得不定矩阵小于0的点，所以说明不定矩阵不会在邻域内正定，而在邻域之外负定。

如果矩阵不是标准型，即二次型含有交叉项，那么可以通过变量替换(正交对角化），使其变为标准型。然后再重新走一遍上面的证明。

正交对角化之后的二次型和之前的二次型是同一个二次型，只不过做了变量替换而已，所以系数矩阵在变换之后的正定性是一样的。


